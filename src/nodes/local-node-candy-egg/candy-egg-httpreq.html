<script type='text/x-red' data-template-name='CANDY EGG HTTP Endpoint'>
  <div class='form-row' id='candy-egg-ws-account-row'>
    <label for='node-input-account'><i class='fa fa-user'></i> <span data-i18n='candy-egg-httpreq.label.account'></span></label>
    <input type='text' id='node-input-account'>
  </div>
  <div class='form-row'>
    <label for='node-input-method'><i class='fa fa-tasks'></i> <span data-i18n='candy-egg-httpreq.label.method'></span></label>
    <select type='text' id='node-input-method' style='width:72%;'>
    <option value='GET'>GET</option>
    <option value='POST'>POST</option>
    <option value='PUT'>PUT</option>
    <option value='DELETE'>DELETE</option>
    <option value='use' data-i18n='candy-egg-httpreq.setby'></option>
    </select>
  </div>
  <div class='form-row'>
    <label for='node-input-path'><i class='fa fa-bookmark'></i> <span data-i18n='candy-egg-httpreq.label.path'></span></label>
    <input type='text' id='node-input-path'>
  </div>
  <div class='form-row'>
    <label for='node-input-ret'><i class='fa fa-arrow-left'></i> <span data-i18n='candy-egg-httpreq.label.return'></span></label>
    <select type='text' id='node-input-ret' style='width:72%;'>
    <option value='obj' data-i18n='candy-egg-httpreq.json'></option>
    <option value='bin' data-i18n='candy-egg-httpreq.binary'></option>
    <option value='txt' data-i18n='candy-egg-httpreq.utf8'></option>
    </select>
  </div>
  <div class='form-row'>
    <label for='node-input-name'><i class='fa fa-tag'></i> <span data-i18n='node-red:common.label.name'></span></label>
    <input type='text' id='node-input-name' data-i18n='[placeholder]node-red:common.label.name'>
  </div>
  <div class='form-tips' id='tip-json' hidden><span data-i18n='candy-egg-httpreq.tip.req'></span></div>
</script>

<script type='text/javascript'>
  RED.nodes.registerType('CANDY EGG HTTP Endpoint',{
    category: 'function',
    color:'rgb(128, 219, 255)',
    defaults: {
      name: {value:''},
      account: {type: 'CANDY EGG Account', required: true},
      method:{value:'GET'},
      ret: {value:'obj'},
      path:{value:''},
    },
    inputs:1,
    outputs:1,
    icon: 'candy-egg.png',
    label: function() {
      var accountNode = RED.nodes.node(this.account);
      return (accountNode ? accountNode.label() +
        (this.path ? ' ' + this.method + ' ' + this.path : '') :
        this._('candy-egg-httpreq.label.category'));
    },
    labelStyle: function() {
      return this.name?'node_label_italic':'';
    },
    oneditprepare: function() {
      $('#node-input-ret').change(function() {
        if ($('#node-input-ret').val() === 'obj') {
          $('#tip-json').show();
        } else {
          $('#tip-json').hide();
        }
      });
    }
  });
</script>
